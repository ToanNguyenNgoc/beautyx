{"version":3,"file":"static/js/884.1e294799.chunk.js","mappings":"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","sources":["pages/_DiscountDetail/useDiscountDetail.ts","pages/_DiscountDetail/index.tsx"],"sourcesContent":["/* eslint-disable react-hooks/exhaustive-deps */\nimport { AUTH_LOCATION } from \"api/authLocation\"\nimport API_ROUTE from \"api/_api\"\nimport { useGetParamUrl, useSwr } from \"hooks\"\nimport { useEffect } from \"react\"\nimport { useHistory } from \"react-router-dom\"\n\nconst routeType = [\n    {\n        path: 'service', type: 'SERVICE', api: 'services', params: {\n            'include': 'category|favorites_count',\n            'append': 'is_favorite|rating|bought_count'\n        }\n    },\n    {\n        path: 'product', type: 'PRODUCT', api: 'products', params: {\n            'append': 'is_favorite|rating',\n            'include': 'category|favorites_count'\n        }\n    },\n]\n\nexport function useDiscountDetail() {\n    const history = useHistory()\n    const paramsUrl = useGetParamUrl()\n    const typeItemProps = routeType.find(i => i.path === paramsUrl[0])\n    const params = {\n        id: parseInt(paramsUrl[2]),\n        org_id: parseInt(paramsUrl[1]),\n        item_id: parseInt(paramsUrl[3])\n    }\n    let redirectPageError = false\n    if (!typeItemProps) redirectPageError = true\n    useEffect(() => {\n        if (redirectPageError) history.replace('/error')\n    }, [])\n    const discount = useDiscount(params)\n    const detail = useItem(params, typeItemProps)\n    const org = useOrg(params)\n\n    return { discount, org, detail, typeItemProps }\n}\nconst useDiscount = (params: any) => {\n    const history = useHistory()\n    const { response, error } = useSwr(\n        `${API_ROUTE.DISCOUNTS_ID(params.id)}`,\n        params.id,\n        { 'append': 'user_available_purchase_count' }\n    )\n    useEffect(() => {\n        if (error) history.replace('/error')\n    }, [error])\n    return response\n}\nconst useItem = (params: any, typeItemProps: any) => {\n    const history = useHistory()\n    const { response, error } = useSwr(\n        `/organizations/${params.org_id}/${typeItemProps?.api}/${params.item_id}`,\n        (params.org_id && params.item_id && typeItemProps),\n        typeItemProps?.params\n    )\n    useEffect(() => {\n        if (error) history.replace('/error')\n    }, [error])\n    return response\n}\nconst useOrg = (params: any) => {\n    const history = useHistory()\n    const LOCATION = AUTH_LOCATION()\n    const { response, error } = useSwr(\n        `${API_ROUTE.ORG(params.org_id)}`,\n        params.org_id,\n        { 'filter[location]': LOCATION }\n    )\n    useEffect(() => {\n        if (error) history.replace('/error')\n    }, [error])\n    return response\n}","import LoadDetail from 'components/LoadingSketion/LoadDetail';\nimport Head from 'features/Head';\nimport { useDeviceMobile, useFavorite } from 'hooks';\nimport HeadOrg from 'pages/MerchantDetail/components/HeadOrg';\nimport { DetailProp } from 'pages/_SerProCoDetail/detail.interface';\nimport React, { useState } from 'react';\nimport { useDiscountDetail } from './useDiscountDetail';\nimport style from '../_SerProCoDetail/detail.module.css'\nimport { Container, Drawer, Rating } from '@mui/material';\nimport Slider from 'react-slick';\nimport { onErrorImg } from 'utils';\nimport formatPrice from 'utils/formatPrice';\nimport icon from 'constants/icon';\nimport { AlertSnack, OpenApp, ShareSocial, XButton } from 'components/Layout';\nimport { DetailDesc, DetailOrgCard, DetailRecommend } from 'pages/_SerProCoDetail';\nimport Comment from 'components/Comment';\nimport { IDiscountPar, IOrganization } from 'interface';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useHistory, useLocation } from 'react-router-dom';\nimport IStore from 'interface/IStore';\nimport { PopupMessage } from 'components/Notification';\nimport { formatAddCart } from 'utils/cart/formatAddCart';\nimport { addCart } from 'redux/cartSlice';\nimport GoogleTagPush, { GoogleTagEvents } from 'utils/dataLayer';\nimport tracking from 'api/trackApi'\nimport { clearAllServices } from 'redux/servicesBookSlice';\n\nfunction DiscountDetail() {\n    const IS_MB = useDeviceMobile()\n    const { detail, org, discount, typeItemProps } = useDiscountDetail()\n    const location = useLocation()\n    const history = useHistory()\n    //display special price\n    let specialPrice = discount?.discount_value\n    if (discount?.discount_type === 'PRODUCT') {\n        specialPrice = detail?.price ?? detail?.retail_price - discount?.discount_value\n    }\n    //---\n\n    // console.log(discount)\n    const DETAIL: DetailProp = {\n        name: detail?.service_name ?? detail?.product_name ?? '',\n        type: typeItemProps?.type ?? 'SERVICE',\n        SPECIAL_PRICE: specialPrice,\n        PRICE: detail?.price ?? detail?.retail_price,\n        ...detail\n    }\n    const PERCENT = Math.ceil(100 - DETAIL.SPECIAL_PRICE / DETAIL.PRICE * 100)\n    const { favoriteSt, onToggleFavorite } = useFavorite({\n        id: DETAIL.id,\n        org_id: org?.id,\n        type: typeItemProps?.type === 'SERVICE' ? 'SERVICE' : 'PRODUCT',\n        count: DETAIL.favorites_count,\n        favorite: DETAIL.is_favorite\n    })\n    //----\n    const settings = {\n        dots: false,\n        arrows: false,\n        speed: 900,\n        slidesToShow: 1,\n        slidesToScroll: 1,\n        swipe: true,\n    }\n    const onNavigateCateList = () => {\n        if (org?.id) {\n            history.push(`/cua-hang/${org.subdomain}/dich-vu?cate_id=${DETAIL.category?.id}`)\n        }\n    }\n\n    return (\n        (detail && org && discount) ?\n            <>\n                {IS_MB ? <HeadOrg onBackFunc={() => history.goBack()} org={org} /> : <Head title={DETAIL.name} />}\n                <Container>\n                    <div className={style.wrapper} >\n                        <div className={style.container}>\n                            <div className={style.container_head}>\n                                <div className={style.container_head_left}>\n                                    <div className={style.container_head_img_slide}>\n                                        <Slider\n                                            {...settings}\n                                            className={style.slide}\n                                        >\n                                            {\n                                                DETAIL.video_url &&\n                                                <div className={style.media_item_video}>\n                                                    <video\n                                                        className={style.media_item_bg}\n                                                        src={DETAIL.video_url}>\n\n                                                    </video>\n                                                    <video\n                                                        className={style.video_container}\n                                                        loop\n                                                        controls\n                                                        webkit-playsinline=\"webkit-playsinline\"\n                                                        playsInline={true}\n                                                    >\n                                                        <source src={DETAIL.video_url} />\n                                                    </video>\n                                                </div>\n                                            }\n                                            {\n                                                [DETAIL.image_url].map(i => (\n                                                    <div\n                                                        style={IS_MB ? {\n                                                            height: `414px`\n                                                        } : {}}\n                                                        key={i} className={style.media_item_img}\n                                                    >\n                                                        <img src={i ?? org.image_url} onError={(e) => onErrorImg(e)} alt=\"\" />\n                                                    </div>\n                                                ))\n                                            }\n                                        </Slider>\n                                    </div>\n                                    <div className={style.container_head_img_thumb}>\n                                        {!IS_MB && <ShareSocial url={location.pathname} />}\n                                    </div>\n                                </div>\n                                <div className={style.container_head_right}>\n                                    <div>\n                                        {\n                                            DETAIL.category &&\n                                            <div className={style.detail_cate}>\n                                                Loại: <span onClick={onNavigateCateList}>{DETAIL.category?.name}</span>\n                                            </div>\n                                        }\n                                        <span className={style.detail_name}>{DETAIL.name}</span>\n                                        <div className={style.duration}>\n                                            {\n                                                DETAIL.duration > 0 &&\n                                                <div className={style.duration_item}>\n                                                    <img src={icon.clockGray} className={style.duration_item_icon} alt=\"\" />\n                                                    <span className={style.duration_item_text}>{DETAIL.duration} phút</span>\n                                                </div>\n                                            }\n                                        </div>\n                                        <div className={style.detail_buy}>\n                                            <div className={style.detail_price}>\n                                                <div className={style.detail_price_left}>\n                                                    {\n                                                        DETAIL.SPECIAL_PRICE > 0 &&\n                                                        <span className={style.price_percent}>\n                                                            -{PERCENT}%\n                                                        </span>\n                                                    }\n                                                    <div className={style.price}>\n                                                        {DETAIL.SPECIAL_PRICE > 0 && <span>{formatPrice(DETAIL.SPECIAL_PRICE)}đ</span>}\n                                                        <span>{formatPrice(DETAIL.PRICE)}đ</span>\n                                                    </div>\n                                                </div>\n                                                <div className={style.detail_price_right}>\n                                                    <XButton\n                                                        className={style.right_btn}\n                                                        icon={favoriteSt.is_favorite ? icon.heart : icon.unHeart}\n                                                        iconSize={20}\n                                                        onClick={onToggleFavorite}\n                                                    />\n                                                </div>\n                                            </div>\n                                            <div className={style.detail_rate}>\n                                                <div className={style.detail_rate_item}>\n                                                    <Rating name=\"read-only\" value={5} readOnly />\n                                                </div>\n                                                <div className={style.detail_rate_item}>\n                                                    <span className={style.detail_rate_item_count}>{favoriteSt.favorite_count}</span>\n                                                    <img src={icon.heart} className={style.detail_rate_icon} alt=\"\" />\n                                                </div>\n                                                {\n                                                    DETAIL.bought_count &&\n                                                    <div className={style.detail_rate_item}>\n                                                        <span className={style.detail_rate_item_count}>\n                                                            {DETAIL.bought_count} đã bán\n                                                        </span>\n                                                    </div>\n                                                }\n                                            </div>\n                                        </div>\n                                        {!IS_MB && <DetailOrgCard org={org} />}\n                                    </div>\n                                    {\n                                        !IS_MB &&\n                                        <DetailQuantity discount={discount} org={org} detail={DETAIL} />\n                                    }\n                                </div>\n                            </div>\n                        </div>\n                        <DetailDesc detail={DETAIL} org={org} />\n                        {\n                            IS_MB &&\n                            <div className={style.org_card_mb}>\n                                <DetailOrgCard org={org} />\n                            </div>\n                        }\n                        <DetailRecommend detail={DETAIL} org={org} />\n                        <div className={style.comment_cnt}>\n                            <Comment\n                                org_id={org?.id}\n                                commentable_id={DETAIL.id}\n                                commentable_type={DETAIL.type}\n                            />\n                        </div>\n                        {\n                            IS_MB &&\n                            <DetailBottom PERCENT={PERCENT} discount={discount} org={org} detail={DETAIL} />\n                        }\n                    </div>\n                </Container>\n                <OpenApp\n                    type='discount'\n                    id={discount.id}\n                    item_id={DETAIL.id}\n                    org_id={org?.id}\n                />\n            </>\n            :\n            <LoadDetail />\n    );\n}\n\nexport default DiscountDetail;\n\ninterface DetailQuantityProps {\n    discount: IDiscountPar,\n    org: IOrganization,\n    detail: DetailProp,\n    draType?: string\n}\nconst DetailBottom = (\n    { detail, org, discount, PERCENT }:\n        { detail: DetailProp, org: IOrganization, discount: IDiscountPar, PERCENT: number }\n) => {\n    const [dra, setDra] = useState({\n        open: false, type: ''\n    })\n    return (\n        <div className={style.bottom}>\n            <XButton\n                title={detail.type === 'SERVICE' ? 'Đặt hẹn ngay' : 'Mua ngay'}\n                onClick={() => setDra({ open: true, type: 'NOW' })}\n            />\n            <XButton\n                title='Thêm vào giỏ hàng'\n                onClick={() => setDra({ open: true, type: 'ADD_CART' })}\n            />\n            <Drawer anchor='bottom' open={dra.open} onClose={() => setDra({ open: false, type: '' })} >\n                <div className={style.bottom_wrapper}>\n                    <div className={style.bottom_detail}>\n                        <img src={detail.image_url} className={style.bottom_detail_img} alt=\"\" />\n                        <div className={style.bottom_detail_info}>\n                            <p className={detail.name}>{detail.name}</p>\n                            <div className={style.duration}>\n                                {\n                                    detail.duration > 0 &&\n                                    <div className={style.duration_item}>\n                                        <img src={icon.clockGray} className={style.duration_item_icon} alt=\"\" />\n                                        <span className={style.duration_item_text}>{detail.duration} phút</span>\n                                    </div>\n                                }\n                            </div>\n                            <div className={style.detail_price_left}>\n                                {\n                                    detail.SPECIAL_PRICE > 0 &&\n                                    <span className={style.price_percent}>\n                                        -{PERCENT}%\n                                    </span>\n                                }\n                                <div className={style.price}>\n                                    {detail.SPECIAL_PRICE > 0 && <span>{formatPrice(detail.SPECIAL_PRICE)}đ</span>}\n                                    <span>{formatPrice(detail.PRICE)}đ</span>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <DetailQuantity\n                        draType={dra.type} org={org} detail={detail}\n                        discount={discount}\n                    />\n                </div>\n            </Drawer>\n        </div>\n    )\n}\n\nconst DetailQuantity = (props: DetailQuantityProps) => {\n    const { discount, org, detail, draType } = props\n    const [quantity, setQuantity] = useState(1)\n    const [open, setOpen] = useState(false)\n    const dispatch = useDispatch()\n    const { USER } = useSelector((state: IStore) => state.USER)\n    const history = useHistory()\n    const onDescQuantity = () => quantity > 1 && setQuantity(quantity - 1)\n    const checkType = () => {\n        let typeNumber\n        switch (detail.type) {\n            case 'SERVICE':\n                typeNumber = 2\n                break;\n            case 'PRODUCT':\n                typeNumber = 1\n                break;\n            default:\n                break;\n        }\n        return typeNumber\n    }\n    const is_type = checkType()\n    const values = formatAddCart(\n        detail,\n        org,\n        is_type,\n        quantity,\n        detail.PRICE,\n        discount.user_available_purchase_count > 0 ? discount : null\n    );\n    const handleAddCart = () => {\n        if (!USER) return history.push('/sign-in?1')\n        dispatch(addCart({\n            ...values,\n            cart_id: parseInt(`${USER.id}${values.cart_id}`),\n            user_id: USER.id\n        }));\n        GoogleTagPush(GoogleTagEvents.ADD_TO_CART);\n        tracking.ADD_CART_CLICK(\n            values.org_id,\n            values.id,\n            values.price,\n            values.quantity\n        );\n        setOpen(true)\n    }\n    const onBookingNow = () => {\n        const TYPE = \"BOOK_NOW\";\n        const service = {\n            ...detail,\n            discount: discount.user_available_purchase_count > 0 ? discount : null\n        };\n        const services = [{ service, quantity: quantity }];\n        tracking.ADD_CART_CLICK(values.org_id, values.id, values.price, values.quantity)\n        GoogleTagPush(GoogleTagEvents.ADD_TO_CART);\n        history.push({\n            pathname: \"/dat-hen\",\n            state: { org, services, TYPE },\n        });\n        dispatch(clearAllServices());\n    }\n    return (\n        <div>\n            {\n                discount.discount_type === 'PRODUCT' && quantity > 1 &&\n                <p className={style.price_warning}>\n                    Giá dịch vụ đã thay đổi vì bạn chọn nhiều hơn số lượng được áp dụng mã\n                </p>\n            }\n            <div className={style.detail_cart}>\n                <div className={style.detail_quantity}>\n                    <span className={style.detail_quantity_title}>Số lượng</span>\n                    <div className={style.detail_quantity_calc}>\n                        <XButton\n                            title='-'\n                            className={style.detail_quantity_btn}\n                            onClick={onDescQuantity}\n                        />\n                        <span className={style.quantity}>{quantity}</span>\n                        <XButton\n                            title='+'\n                            className={style.detail_quantity_btn}\n                            onClick={() => setQuantity(quantity + 1)}\n                        />\n                    </div>\n                </div>\n                <div className={style.add_cart}>\n                    {detail.type === 'SERVICE' &&\n                        <XButton\n                            style={draType === \"NOW\" ? { display: 'flex' } : {}}\n                            title='Đặt hẹn ngay'\n                            className={style.add_cart_btn}\n                            onClick={onBookingNow}\n                        />\n                    }\n                    <XButton\n                        style={draType === \"ADD_CART\" ? { display: 'flex' } : {}}\n                        icon={icon.cartWhiteBold}\n                        iconSize={15}\n                        title='Thêm vào giỏ hàng'\n                        className={style.add_cart_btn}\n                        onClick={handleAddCart}\n                    />\n                </div>\n                {\n                    discount?.user_available_purchase_count > 0 ?\n                        <PopupMessage\n                            iconLabel={detail.image_url}\n                            content={`Đã thêm ${detail.name} vào giỏ hàng`}\n                            open={open}\n                            onClose={() => setOpen(false)}\n                            autoHide={true}\n                        />\n                        :\n                        <AlertSnack\n                            open={open}\n                            onClose={() => setOpen(false)}\n                            status=\"WARNING\"\n                            title={`Bạn đã hết lượt mua với giá khuyến mại`}\n                        // title={`Giá bán này chỉ áp dụng ${discount.limit}lượt mua/người`}\n                        />\n                }\n            </div>\n        </div>\n    )\n}"],"names":["routeType","path","type","api","params","useDiscount","history","useHistory","response","error","useSwr","API_ROUTE","id","useEffect","replace","useItem","typeItemProps","org_id","item_id","useOrg","LOCATION","AUTH_LOCATION","IS_MB","useDeviceMobile","detail","org","discount","paramsUrl","useGetParamUrl","find","i","parseInt","redirectPageError","useDiscountDetail","location","useLocation","specialPrice","discount_value","discount_type","price","retail_price","DETAIL","name","service_name","product_name","SPECIAL_PRICE","PRICE","PERCENT","Math","ceil","favoriteSt","onToggleFavorite","useFavorite","count","favorites_count","favorite","is_favorite","HeadOrg","onBackFunc","goBack","Head","title","Container","className","style","dots","arrows","speed","slidesToShow","slidesToScroll","swipe","video_url","src","loop","controls","playsInline","image_url","map","height","onError","e","onErrorImg","alt","url","pathname","category","onClick","push","subdomain","duration","icon","formatPrice","iconSize","Rating","value","readOnly","favorite_count","bought_count","DetailQuantity","Comment","commentable_id","commentable_type","DetailBottom","LoadDetail","dra","setDra","useState","open","Drawer","anchor","onClose","draType","props","quantity","setQuantity","setOpen","dispatch","useDispatch","USER","useSelector","state","is_type","typeNumber","checkType","values","formatAddCart","user_available_purchase_count","display","services","service","tracking","GoogleTagPush","GoogleTagEvents","TYPE","clearAllServices","addCart","cart_id","user_id","iconLabel","content","autoHide","status"],"sourceRoot":""}