{"version":3,"file":"static/js/566.01554021.chunk.js","mappings":"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","sources":["webpack://web-booking/./src/pages/VoucherPage/style.module.css?0da5","pages/VoucherPage/index.tsx"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport default {\"voucher_page\":\"style_voucher_page__NITQi\",\"voucher_list\":\"style_voucher_list__T4qqB\",\"voucher_item_cnt\":\"style_voucher_item_cnt__p+O+I\",\"voucher_item\":\"style_voucher_item__NDeFh\",\"voucher_item_left\":\"style_voucher_item_left__mgl01\",\"voucher_item_right\":\"style_voucher_item_right__JXzaR\",\"voucher_item_img\":\"style_voucher_item_img__diAC2\",\"voucher_item_expiry\":\"style_voucher_item_expiry__nM2HP\",\"voucher_info_name\":\"style_voucher_info_name__zJOCu\",\"voucher_info_price\":\"style_voucher_info_price__N4nji\",\"voucher_item_btn\":\"style_voucher_item_btn__iEB7o\",\"infinite-scroll-component\":\"style_infinite-scroll-component__ZPNFf\",\"vouvher_loadmore_wrap\":\"style_vouvher_loadmore_wrap__8CgmP\",\"load_item_cnt\":\"style_load_item_cnt__auGQh\",\"load_item_left\":\"style_load_item_left__eYwCT\",\"load_item_right\":\"style_load_item_right__fD8wU\",\"load_item_right_item\":\"style_load_item_right_item__CksjV\",\"voucher_loadmore_btn\":\"style_voucher_loadmore_btn__f0YXy\"};","import React from \"react\";\nimport style from \"./style.module.css\";\nimport { useDeviceMobile, useSwrInfinite } from \"hooks\";\nimport HeadMobile from \"features/HeadMobile\";\nimport { Container } from \"@mui/material\";\nimport { XButton } from \"components/Layout\";\nimport { paramsDiscounts } from \"params-query\";\nimport { EXTRA_FLAT_FORM } from \"api/extraFlatForm\";\nimport { IDiscountPar, IITEMS_DISCOUNT } from \"interface\";\nimport { DISCOUNT_TYPE } from \"../../utils/formatRouterLink/fileType\";\nimport formatPrice from \"utils/formatPrice\";\nimport { useHistory } from \"react-router-dom\";\nimport tracking from \"api/trackApi\";\nimport { analytics, logEvent } from \"../../firebase\";\nimport { formatRouterLinkDiscount } from \"utils/formatRouterLink/formatRouter\";\nimport dayjs from \"dayjs\";\nimport Skeleton from \"react-loading-skeleton\";\nimport InfiniteScroll from \"react-infinite-scroll-component\";\nimport { BackTopButton } from \"components/Layout\";\n\ninterface DiscountItemsType extends IITEMS_DISCOUNT {\n    discount: IDiscountPar\n}\n\nexport default function VoucherPage() {\n    const IS_MB = useDeviceMobile();\n    const PLAT_FORM = EXTRA_FLAT_FORM();\n    const newParams = {\n        ...paramsDiscounts,\n        limit: 30,\n        sort: PLAT_FORM === \"TIKI\" ? \"-priority\" : \"\",\n    };\n    const { resData, totalItem, onLoadMore } = useSwrInfinite(\n        true,\n        \"/discounts\",\n        newParams\n    );\n    const discounts = resData ?? [];\n    const onViewMore = () => {\n        if (resData.length < totalItem) {\n            onLoadMore()\n        }\n    }\n    const discountItems: DiscountItemsType[] = discounts.map((i: IDiscountPar) => {\n        const items = i.items.map((child: IITEMS_DISCOUNT) => {\n            return {\n                ...child,\n                discount: i\n            }\n        })\n        return items.flat()\n    }).flat()\n\n    return (\n        <div>\n            {IS_MB && <HeadMobile title=\"Voucher\" />}\n            <Container>\n                <div className={style.voucher_page}>\n                    <InfiniteScroll\n                        dataLength={discounts.length}\n                        hasMore={true}\n                        loader={<></>}\n                        next={onViewMore}\n                    >\n                        <div className={style.voucher_list}>\n                            {\n                                discountItems.map((item: DiscountItemsType, index: number) => (\n                                    <ItemDiscount\n                                        item={item}\n                                        key={index}\n                                    />\n                                ))\n                            }\n                        </div>\n                        {resData.length < totalItem && <LoadSkelton />}\n                    </InfiniteScroll>\n                </div>\n            </Container>\n            <BackTopButton />\n        </div>\n    );\n}\n\nconst ItemDiscount = ({ item }: { item: DiscountItemsType }) => {\n    const history = useHistory();\n    const onDetail = (item: IITEMS_DISCOUNT, discount: IDiscountPar) => {\n        tracking.DISCOOUNT_ITEM_CLICK(\n            item.organization.id,\n            \"khuyến mãi hot\",\n            item.discount_id\n        );\n        logEvent(analytics, \"detail_discount\", {\n            service: item.productable.product_name,\n            merchant: item.organization.name,\n        });\n        history.push(formatRouterLinkDiscount(discount, item));\n    };\n    return (\n        <div className={style.voucher_item_cnt}>\n            <div\n                className={style.voucher_item}\n            >\n                <div\n                    className={\n                        style.voucher_item_left\n                    }\n                >\n                    <div\n                        className={\n                            style.voucher_item_img\n                        }\n                    >\n                        <img\n                            src={\n                                item\n                                    ?.productable\n                                    ?.image\n                                    ? item\n                                        .productable\n                                        ?.image_url\n                                    : item\n                                        .organization\n                                        ?.image_url\n                            }\n                            alt=\"\"\n                        />\n                    </div>\n                </div>\n                <div\n                    className={\n                        style.voucher_item_right\n                    }\n                >\n                    <div\n                        className={\n                            style.voucher_item_info\n                        }\n                    >\n                        <div\n                            className={\n                                style.voucher_info_name\n                            }\n                        >\n                            <span>\n                                {item\n                                    ?.productable\n                                    ?.service_name ||\n                                    item\n                                        ?.productable\n                                        ?.product_name}\n                            </span>\n                        </div>\n                        <div\n                            className={\n                                style.voucher_info_price\n                            }\n                        >\n                            <p>\n                                {formatPrice(\n                                    item\n                                        ?.productable\n                                        ?.price ||\n                                    item\n                                        ?.productable\n                                        ?.retail_price\n                                )}\n                                đ\n                            </p>\n                            <p>\n                                Giảm còn:{\" \"}\n                                <span>\n                                    {item.discount?.discount_type ===\n                                        DISCOUNT_TYPE\n                                            .FINAL_PRICE\n                                            .key\n                                        ? `${formatPrice(\n                                            item.discount?.discount_value\n                                        )}đ`\n                                        : `${formatPrice(\n                                            item?.view_price\n                                        )}đ`}\n                                </span>\n                            </p>\n                        </div>\n                        <div\n                            className={\n                                style.voucher_item_expiry\n                            }\n                        >\n                            <p>\n                                HSD:{\" \"}\n                                {item.discount?.valid_from &&\n                                    dayjs(\n                                        item.discount?.valid_from\n                                    ).format(\n                                        \"DD/MM/YYYY\"\n                                    )}{\" \"}\n                                {\"- \"}\n                                {item.discount?.valid_util &&\n                                    dayjs(\n                                        item.discount?.valid_util\n                                    ).format(\n                                        \"DD/MM/YYYY\"\n                                    )}\n                            </p>\n                        </div>\n                    </div>\n                    <XButton\n                        onClick={()=>onDetail(item, item.discount)}\n                        title={\"Chi tiết\"}\n                        className={`${style.voucher_item_btn}`}\n                    />\n                </div>\n            </div>\n        </div>\n    )\n}\nconst LoadSkelton = () => {\n    const counts = [1, 2, 3, 4, 5, 6, 7, 8];\n    return (\n        <div className={style.voucher_list}>\n            {counts.map((i) => (\n                <div key={i} className={style.load_item_cnt}>\n                    <div className={style.load_item_left}>\n                        <Skeleton width={\"100%\"} height={\"100%\"} />\n                    </div>\n                    <div className={style.load_item_right}>\n                        <div className={style.load_item_right_item}>\n                            <Skeleton width={\"100%\"} height={\"100%\"} />\n                        </div>\n                        <div className={style.load_item_right_item}>\n                            <Skeleton width={\"100%\"} height={\"100%\"} />\n                        </div>\n                    </div>\n                </div>\n            ))}\n        </div>\n    );\n};\n"],"names":["VoucherPage","IS_MB","useDeviceMobile","PLAT_FORM","EXTRA_FLAT_FORM","newParams","paramsDiscounts","limit","sort","resData","totalItem","onLoadMore","useSwrInfinite","discounts","discountItems","map","i","items","child","discount","flat","HeadMobile","title","Container","className","style","dataLength","length","hasMore","loader","next","item","index","ItemDiscount","LoadSkelton","history","useHistory","src","productable","image","image_url","organization","alt","service_name","product_name","formatPrice","price","retail_price","discount_type","DISCOUNT_TYPE","discount_value","view_price","valid_from","dayjs","format","valid_util","onClick","tracking","id","discount_id","logEvent","analytics","service","merchant","name","push","formatRouterLinkDiscount","onDetail","width","height"],"sourceRoot":""}