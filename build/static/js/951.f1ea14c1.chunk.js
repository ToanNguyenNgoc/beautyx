"use strict";(self.webpackChunkweb_booking=self.webpackChunkweb_booking||[]).push([[951],{84951:function(e,t,n){n.r(t),n.d(t,{default:function(){return f}});var o=n(27565),i=n(75068),a=n(3737),s=n(5135),r={body:"otp_body__UBHW1",form_btn:"otp_form_btn__83+hr",btn_send_telephone:"otp_btn_send_telephone__U+EHG",container_title:"otp_container_title__-vf4-"},l=n(85711),c=n(56204),h=n(10025),d=n(63763),p=n(15985),u=n(48127),m=n(18003),_=n(17258),b=n(34328),g=n(27929);window.confirmationResult=window.confirmationResult||{};var f=function(){const[e,t]=(0,o.useState)(1),[n,i]=(0,o.useState)({telephone:"",code:"",verification_id:""});return(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)("div",{className:r.body,children:[1===e&&(0,g.jsx)(x,{data:n,setData:i,step:e,setStep:t}),2===e&&(0,g.jsx)(j,{data:n,setData:i,step:e,setStep:t})]})})};const x=e=>{const{data:t,setData:n,setStep:u}=e,{t:m}=(0,o.useContext)(h.B),{noti:_,firstLoad:b,resultLoad:f,onCloseNoti:x}=(0,d.m4)(),j=(0,l.Wx)({initialValues:{telephone:t.telephone},validationSchema:s.Ik({telephone:s.Yj().required(m("form.please_enter_your_phone"))}),onSubmit:e=>{(async()=>{try{window.recaptchaVerifier?window.recaptchaVerifier.render():window.recaptchaVerifier=new a.kT("recaptcha-container",{size:"invisible",callback:e=>{},"expired-callback":()=>{}},a.jh)}catch(e){console.log(e)}})(),(async e=>{b();let o="+84"+e.telephone.toString().slice(1);try{const i=await(0,a.ik)(a.jh,o,window.recaptchaVerifier);n({...t,telephone:e.telephone,verification_id:i.verificationId}),f(""),u(2)}catch(i){console.log(i);let e=i.code,t=i.message;f("auth/quota-exceeded"===e||"auth/too-many-requests"===e?"S\u1ed1 \u0111i\u1ec7n tho\u1ea1i \u0111\xe3 \u0111\u1ea1t gi\u1edbi h\u1ea1n cho ph\xe9p g\u1eedi m\xe3 x\xe1c th\u1ef1c (OTP) trong ng\xe0y":"reCAPTCHA has already been rendered in this element"===t?"Qu\xe1 s\u1ed1 l\u1ea7n nh\u1eadn Otp t\u1ea3i l\u1ea1i trang \u0111\u1ec3 ti\u1ebfp t\u1ee5c ...":"Qu\xe1 s\u1ed1 l\u1ea7n nh\u1eadn Otp t\u1ea3i l\u1ea1i trang \u0111\u1ec3 ti\u1ebfp t\u1ee5c ..")}})(e)}});return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(i.A,{title:"C\u1eadp nh\u1eadt th\xf4ng tin"}),(0,g.jsxs)("div",{className:r.container,children:[(0,g.jsx)("div",{id:"recaptcha-container"}),(0,g.jsxs)("form",{className:r.form_cnt,autoComplete:"off",onSubmit:j.handleSubmit,children:[(0,g.jsx)(c.pd,{onChange:j.handleChange,name:"telephone",value:j.values.telephone,placeholder:m("pm.phone_number")}),j.errors.telephone&&j.touched.telephone&&(0,g.jsx)("span",{className:"for-pass-cnt__phone-err",children:j.errors.telephone}),(0,g.jsx)("div",{className:r.form_btn,children:(0,g.jsx)(c.b2,{className:r.btn_send_telephone,title:"G\u1eedi m\xe3 x\xe1c nh\u1eadn",type:"submit",loading:_.load})})]}),(0,g.jsx)(p.M_,{open:_.openAlert,setOpen:x,title:"Th\xf4ng b\xe1o",content:_.message,children:(0,g.jsx)(c.b2,{title:"\u0110\xe3 hi\u1ec3u",onClick:x})})]})]})},j=e=>{const t=(0,b.W6)(),n=(0,u.wA)(),{data:o}=e,{noti:a,firstLoad:h,resultLoad:f,onCloseNoti:x}=(0,d.m4)(),{USER:j}=(0,u.d4)((e=>e.USER)),v=(0,l.Wx)({initialValues:{code:""},validationSchema:s.Ik({code:s.Yj().required("Vui l\xf2ng nh\u1eadp m\xe3 OTP")}),onSubmit:e=>{(async e=>{const i={...o,code:e.code};h();try{await m.j.putUserProfile(i)&&(n((0,_.vv)({...j,telephone:o.telephone})),f("Thay \u0111\u1ed5i th\xf4ng tin th\xe0nh c\xf4ng",(0,g.jsx)(c.b2,{title:"Tr\u1edf l\u1ea1i gi\u1ecf h\xe0ng",onClick:()=>t.goBack()})))}catch(s){var a;switch(null===(a=s.response)||void 0===a?void 0:a.status){case 301:return f("S\u1ed1 \u0111i\u1ec7n tho\u1ea1i \u0111\xe3 t\u1ed3n t\u1ea1i");case 502:return f("L\u1ed7i h\u1ec7 th\u1ed1ng g\u1eedi sms qu\xfd kh\xe1ch vui l\xf2ng th\u1eed l\u1ea1i sau!");default:return f("\u0110\xe3 c\xf3 l\u1ed7i x\u1ea3y ra vui l\xf2ng th\u1eed l\u1ea1i sau!")}}})(e)}});return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(i.A,{title:"Nh\u1eadp m\xe3 OTP",onBack:()=>window.location.reload()}),(0,g.jsxs)("div",{className:r.container,children:[(0,g.jsxs)("div",{className:r.container_title,children:["M\xe3 OTP \u0111\xe3 \u0111\u01b0\u1ee3c g\u1eedi \u0111\u1ebfn s\u1ed1 \u0111i\u1ec7n tho\u1ea1i ",(0,g.jsx)("h4",{children:o.telephone})]}),(0,g.jsxs)("form",{className:r.form_cnt,autoComplete:"off",onSubmit:v.handleSubmit,children:[(0,g.jsx)(c.pd,{onChange:v.handleChange,name:"code",value:v.values.code,placeholder:"Nh\u1eadp m\xe3 OTP"}),v.errors.code&&v.touched.code&&(0,g.jsx)("span",{className:"for-pass-cnt__phone-err",children:v.errors.code}),(0,g.jsx)("div",{className:r.form_btn,children:(0,g.jsx)(c.b2,{className:r.btn_send_telephone,title:"C\u1eadp nh\u1eadt",type:"submit"})})]}),(0,g.jsx)(p.M_,{title:"Th\xf4ng b\xe1o",content:a.message,open:a.openAlert,setOpen:x,children:a.element})]})]})}}}]);
//# sourceMappingURL=951.f1ea14c1.chunk.js.map